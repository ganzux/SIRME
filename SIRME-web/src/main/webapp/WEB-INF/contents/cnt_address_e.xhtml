<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:component
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:fn="http://java.sun.com/jsp/jstl/functions"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:sec="http://www.springframework.org/security/facelets/tags"
    xmlns:p="http://primefaces.org/ui">
    
   	<div id="titlea">
		<h:outputText value="#{msg['direcciones.titulo.save']}" 	rendered="#{addressBean.pageOption eq applicationBean.optionSave}" />
		<h:outputText value="#{msg['direcciones.titulo.update']}" 	rendered="#{addressBean.pageOption eq applicationBean.optionUpdate}" />
		<h:outputText value="#{msg['direcciones.titulo.delete']}" 	rendered="#{addressBean.pageOption eq applicationBean.optionDelete}" />
		<h:outputText value="#{msg['direcciones.titulo.view']}" 	rendered="#{addressBean.pageOption eq applicationBean.optionView}" />
	</div>

	<h:form id="form">

		<p:panel id="panel" header="Datos del Cliente *" style="width:37%;position:absolute;">
		
			<p:commandButton value="Buscar" id="butCus" ajax="true" icon="ui-icon-circle-zoomin" rendered="#{addressBean.pageOption eq applicationBean.optionSave or addressBean.pageOption eq applicationBean.optionUpdate}" action="#{customersBean.reloadCustomers}" title="#{msg['boton.buscar']}">
				<f:setPropertyActionListener target="#{addressBean.stackBean.pushPage}"		value="address_e" />
            </p:commandButton>

	        <h:panelGrid columns="2">
	        	<h:outputLabel for="typec" value="Tipo de Cliente" />
	        	<p:inputText id="typec" 	value="#{addressBean.selectedCustomer.typeCustomer.nameTypeCustomer}" 	label="Tipo de Cliente"		size="40"	disabled="true" />

		        <h:outputLabel for="typeAct" value="Activo" />
	        	<p:selectOneMenu id="typeAct" value="#{addressBean.selectedCustomer.active}" disabled="true"> 
		            <f:selectItem itemValue="${true}" itemLabel="Sí" />
		            <f:selectItem itemValue="${false}" itemLabel="No" />
		        </p:selectOneMenu>
	        
	            <h:outputLabel for="name" value="Nombre *" />
	            <p:inputText id="name" 		maxlength="200"	value="${addressBean.selectedCustomer.nameCustomer}" 	label="Nombre"				size="40"	disabled="true" />
	            
	            <h:outputLabel for="cif" value="CIF *" />
	            <p:inputText id="cif" 		maxlength="20"	value="${addressBean.selectedCustomer.cifCustomer}" 	label="CIF"					size="10"	disabled="true" />
	            
	            <h:outputLabel for="code" value="Código *" />
	            <p:inputText id="code" 		maxlength="20"	value="${addressBean.selectedCustomer.codeCustomer}" 	label="Código"				size="10"	disabled="true" />
	            
	            <h:outputLabel for="address" value="Dirección" />
	            <p:inputText id="address" 	maxlength="300"	value="${addressBean.selectedCustomer.mainAddress}" label="Dirección Principal"	size="40"		disabled="true" />

	            <h:outputLabel for="mp1" value="Población" />
	            <p:inputText id="mp1" 		maxlength="300"	value="${addressBean.selectedCustomer.mainPobl}" label="Dirección Principal"	size="40"		disabled="true" />

	            <h:outputLabel for="mp" value="Provincia" />
	            <p:inputText id="mp" 		maxlength="50"	value="${addressBean.selectedCustomer.mainProv}" label="Dirección Principal"	size="40"		disabled="true" />

	            <h:outputLabel for="mcp" value="Código Postal" />
	            <p:inputText id="mcp"  		maxlength="5"	value="${addressBean.selectedCustomer.mainPostalCode}" label="Dirección Principal"	size="5"	disabled="true" />
	            
	            <h:outputLabel for="mail" value="Correo Principal" />
	            <p:inputText id="mail"  	maxlength="100"	value="${addressBean.selectedCustomer.mainMail}" 		label="Correo Principal"	size="40"	disabled="true" />
	            
	            <h:outputLabel for="phone" value="Teléfono Principal" />
	            <p:inputText id="phone"  	maxlength="20"	value="${addressBean.selectedCustomer.mainPhone}" 	label="Teléfono Principal"	size="10"		disabled="true" />
	            
	        </h:panelGrid>
	    </p:panel>
	    
	    <p:panel id="panel2" header="Datos del Contrato *" style="margin-left:40%;width:60%;height:355px;">
	    	<h:panelGrid columns="2">
	    		<h:outputLabel for="ubi" value="Ubicacion" />
	            <p:inputText id="ubi" value="${addressBean.selectedAddress.location}" label="Ubicacion"	size="40"	disabled="#{addressBean.pageOption ne applicationBean.optionSave and addressBean.pageOption ne applicationBean.optionUpdate}"/>
	            
	            <h:outputLabel for="address2" value="Dirección" />
	            <p:inputText id="address2" value="${addressBean.selectedAddress.mainAddress}" label="Dirección"	size="40"	disabled="#{addressBean.pageOption ne applicationBean.optionSave and addressBean.pageOption ne applicationBean.optionUpdate}"/>

	            <h:outputLabel for="mp12" value="Población" />
	            <p:inputText id="mp12" value="${addressBean.selectedAddress.mainPobl}" label="Población"	size="40"	disabled="#{addressBean.pageOption ne applicationBean.optionSave and addressBean.pageOption ne applicationBean.optionUpdate}"/>

	            <h:outputLabel for="mp2" value="Provincia" />
	            <p:inputText id="mp2" value="${addressBean.selectedAddress.mainProv}" label="Provincia"	size="40"	disabled="#{addressBean.pageOption ne applicationBean.optionSave and addressBean.pageOption ne applicationBean.optionUpdate}"/>

	            <h:outputLabel for="mcp2" value="Código Postal" />
	            <p:inputMask id="mcp2" value="${addressBean.selectedAddress.mainPostalCode}" label="Código Postal"	size="5"	maxlength="5"	mask="99999"	disabled="#{addressBean.pageOption ne applicationBean.optionSave and addressBean.pageOption ne applicationBean.optionUpdate}"/>
	            
	            <h:outputLabel for="mcp22" value="Notas" />
	            <p:inputTextarea id="mcp22" value="${addressBean.selectedAddress.other}" label="Varios"	size="5"	disabled="#{addressBean.pageOption ne applicationBean.optionSave and addressBean.pageOption ne applicationBean.optionUpdate}" cols="42" />
	            
				<h:outputLabel for="amount" value="Importe" />
		            <p:inputText id="amount"  	maxlength="10"	value="${addressBean.selectedAddress.amount}" 		label="Importe"				size="5"	disabled="#{addressBean.pageOption ne applicationBean.optionSave and addressBean.pageOption ne applicationBean.optionUpdate}"/>

					<h:column>
		            	<h:outputLabel for="grid" value="Periodicidad" />
		            	<BR />
		            	<h:outputLabel for="grid" value="(#{addressBean.period})" id="period" />
		            </h:column>
		            <p:selectManyCheckbox id="grid" value="#{addressBean.selectedMonths}" layout="grid" columns="4" disabled="#{addressBean.pageOption ne applicationBean.optionSave and addressBean.pageOption ne applicationBean.optionUpdate}">
			            <f:selectItems value="#{addressBean.months}"/>
			        </p:selectManyCheckbox >
	    	</h:panelGrid>
	    </p:panel>

		<p:outputPanel  layout="blobk" styleClass="buttonContainer" rendered="#{addressBean.pageOption eq applicationBean.optionView}" style="position:relative;width:100%;">
			<p:dataTable id="dataTable" var="work" widgetVar="workTable" rowKey="#{work.idWork}"
	    		value="#{addressBean.currentWorks}"
	            emptyMessage="No existen Trabajos de esta Dirección del Cliente" 
	            paginator="true" paginatorPosition="bottom"
		    	rows="#{cfgview['generalRows']}"
		    	paginatorAlwaysVisible="#{cfgview['generalPaginatorAllwaysVisible']}"
		    	paginatorTemplate="#{cfgview['generalPaginator']}"
		    	currentPageReportTemplate="#{cfgview['generalPageReportTemplate']}"
		    	resizableColumns="false"
		    	sortOrder="#{cfgview['generalSortOrder']}">
		    	
		    	<f:facet name="header">
		            <h:outputText value="Partes de Trabajo" /> 
		        </f:facet>
		        
		         <p:column id="s" headerText="Es" sortBy="status" width="20px;" style="align:center">
		        	<p:graphicImage value="/images/status/#{work.status}.png" width="16" title="${work.statusString}" />
		        </p:column>
		        
		        <p:column id="n" headerText="Numero" sortBy="work.codeWork" width="50px;">
		            <h:outputText value="#{work.codeWork}" />
	        	</p:column>

		        <p:column id="cif" headerText="Equipo" sortBy="team.nameTeam" width="125px;">
		            <h:outputText value="#{work.team.nameTeam}" />
		        </p:column>
		        
		        <p:column id="nombre" headerText="Fecha" sortBy="date" width="125px;">
		            <h:outputText value="#{work.date}">
		            	<f:convertDateTime pattern="#{cfgview['dateFormat']}" />
		            </h:outputText>
		        </p:column>
		        
		        <p:column id="address" headerText="Datos" sortBy="memo">
		            <h:outputText value="#{work.memo}" />
		        </p:column>
		        
		        <p:column id="ver" headerText="Acciones" width="100px;">
		            <p:commandButton value="Ver" id="butCus" ajax="true" icon="ui-icon-circle-zoomin" action="works_e" title="Acceder al Parte de Trabajo">
		            	<f:setPropertyActionListener target="#{addressBean.stackBean.pushPage}"		value="address_e" />
		            	<f:setPropertyActionListener target="#{worksBean.selectedWork}"				value="#{work}" />
		            	<f:setPropertyActionListener target="#{worksBean.selectedCustomer}"			value="#{work.customer}" />
		            	<f:setPropertyActionListener target="#{worksBean.selectedTeam}"				value="#{work.team}" />
		            	<f:setPropertyActionListener target="#{worksBean.selectedWork.address}"		value="#{addressBean.selectedAddress}" />
		            	<f:setPropertyActionListener target="#{worksBean.pageOption}"				value="#{applicationBean.optionView}" />
		            </p:commandButton>
		        </p:column>

	    	</p:dataTable>
		</p:outputPanel>

		<p:outputPanel  layout="blobk" styleClass="buttonContainer">
			<h:outputText rendered="#{addressBean.pageOption eq applicationBean.optionDelete}"	value="¿Está seguro de que desea BORRAR la Dirección?"		styleClass="error" />
			<h:outputText rendered="#{addressBean.pageOption eq applicationBean.optionUpdate}"	value="¿Está seguro de que desea ACTUALIZAR la Dirección?"	styleClass="error" />
			
			
	   		<p:commandButton value="Guardar"	action="#{addressBean.save}"	title="#{msg['boton.save']}"	ajax="false" icon="ui-icon-disk" rendered="#{addressBean.pageOption eq applicationBean.optionSave}"		update=":messages" />
	   		<p:commandButton value="Actualizar" action="#{addressBean.update}"	title="#{msg['boton.update']}"	ajax="false" icon="ui-icon-disk" rendered="#{addressBean.pageOption eq applicationBean.optionUpdate}"	update=":messages" />
	   		<p:commandButton value="Borrar" 	action="#{addressBean.delete}"	title="#{msg['boton.delete']}"	ajax="false" icon="ui-icon-disk" rendered="#{addressBean.pageOption eq applicationBean.optionDelete}"	update=":messages" />
           
			<p:commandButton value="Volver" 	action="#{addressBean.back}"	title="#{msg['boton.volver']}"	ajax="true" icon="ui-icon-arrowreturnthick-1-w" rendered="#{addressBean.pageOption eq applicationBean.optionView}"	update=":messages" />
			<p:commandButton value="Cancelar"	action="#{addressBean.cancel}"	title="#{msg['boton.cancel']}"	ajax="true" icon="ui-icon-cancel" 				rendered="#{addressBean.pageOption ne applicationBean.optionView}"	update=":messages" />
		</p:outputPanel>
	
	</h:form>

</ui:component>